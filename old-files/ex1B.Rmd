---
title: "ex1b"
output: html_notebook
---

# Task B1
## Task B1a

The acceptance probability has the form
$$
P(U\leq\frac{f(x)}{cg(x)}) = \int_{-\infty}^{\infty}\frac{f(x)}{cg(x)}g(x)dx = \int_{-\infty}^{\infty}\frac{f(x)}{c}dx = \frac{1}{c}
$$

where $c$ is such that $\frac{f(x)}{g(x)}\leq c$. To find $c$, consider the expression $f(x)\leq cg(x)$. Then we get (for the nontrivial cases when $x>0$)

$$
\frac{1}{\Gamma(\alpha)}x^{\alpha-1}e^{-x}\leq \begin{cases}
c\frac{e\alpha}{e+\alpha}x^{\alpha-1}, 0 < x < 1\\
c\frac{e\alpha}{e+\alpha}e^{-x}, x \geq 1\\
\end{cases}
$$
Rearranging the inequalities and using that $e^{-x}$ and $x^{\alpha-1}$ are decreasing functions, we get the following upper bound for $c$:

$$
c\geq\frac{1}{\Gamma(\alpha)}\frac{e+\alpha}{e\alpha}
$$
So we choose $c = \frac{1}{\Gamma(\alpha)}\frac{e+\alpha}{e\alpha}$ to satisfy our initial inequality. The acceptance probability is then $\frac{1}{c} = \frac{\Gamma(\alpha)e\alpha}{e+\alpha}$.

## Task B1b
We will now demonstrate how to generate $n$ samples of $f$
```{r}
#TODO: Generate n independent samples from f
```



# Task B2
## Task B2a

We can define the domain 
$$
C_f = \Big \{ (x_1, x_2) : 0 \le x_1 \le \sqrt{f^{*}\Big(\frac{x_2}{x_1}\Big)}  \Big \}
$$
where 
$$
f(x) =
\begin{cases}
x^{\alpha -1}e^{-x}, \quad & x> 0 \\
0, \quad & x\le 0 \\
\end{cases}
$$ We now want to define some upper and lower bounds such that 
$$
\begin{align}
a_{-} &= \sqrt{{sup}_x f(x)  } = \sqrt{f(\alpha -1)} \\ 
b_{+} &= \sqrt{{sup}_{x \ge 0} x^2 f(x)  } = \sqrt{(\alpha +1)^2 f(\alpha +1)}\\
b_{-} &= \sqrt{{sup}_{x \le 0} x^2 f(x)  } = 0
\end{align}
$$

The supremum for $a_{-}$ and $b_{+}$ can easily be derived by finding extremal points of the function using derivation and $b_{-}$ follows from $f(x) = 0$ for $x\le 0$.

## Task B2b

We now want to generate $n$ samples of $f$ for different values of $alpha$ 

However, the explicit function will quickly become very large for big $\alpha$. To handle this will we introduce the substitution $x = ln(y) = g(y)$ such that $g^{-1} (x) = e^x,  g^{-1}`(x) = e^x $. Hence, using the change of variable function, we get

$$
\begin{align}
f_Y (y) &= f_X(g^{-1}(x))\cdot \left| \frac{d g^{-1}(x)} {dx} \right| \\
  &= f_X(e^x) \cdot  e^x  \quad \text{completely wrong}
\end{align}
$$

```{r}
# TODO: Write an R function that generates a vector of n independent samples from f. Use the function
# to check how many tries the algorithm needs to generate n = 1000 realisations depending on
# the value of α ∈ (1, 2000]. Generate a plot with values of α on the x-axis and the number of
# tries used on the y-axis. Interpret the result.
# Caution: You need to implement the algorithm on log-scale, otherwise you will get NAs already
# for α around 30.
```


# Task B3


We want to generate $n$ samples of the gamma distribution

$$
f(x) = \frac{\beta^{\alpha}}{\Gamma (\alpha)} x^{\alpha -1} e^{-\beta}
$$



```{r}
# TODO: Write an R function that generates a vector of n independent samples from a gamma distribution
#with parameters α and β. Note that the function should work for any values α > 0 and β > 0,

rate <- 1 
x <- seq(0, 5, by=0.0001)  
alpha =3
beta=1
plot(x,dgamma(x, shape=alpha, rate=beta))

```


