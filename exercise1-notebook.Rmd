---
title: "Exercise 1 - TMA4300 Computer Intensive Statistical Methods"
output: html_notebook
---
Problem A
Question 1
We first want to write an R function that generates  samples from a exponential distribution with rate parameter $\lambda$. 
We know that the cumulative exponential distrobution takes the form $$ F(x;\lambda) =  1 - \lambda e ^{-\lambda x},  \quad x \ge 0 
$$

Computing the inverse cumulative function exploiting the uniform distribution $U \sim Unif(0,1)$ we can get 
$$
X = F^{-1}(U) = - ln (U)/\lambda  
$$

We now want to show that this is true using simulation from the inverse cumulative distribution 

```{r}
expdist <- function(rate, n) {
   u <- runif(n)
   x <-  -log( (1/rate)*( 1 - u))/rate
   list = list(x, u)
   return(list)
}

n <- 60000
lambda <- 1
outval <- expdist(lambda, n)
plot(outval[[1]], outval[[2]], xlab = "x", ylab = "y")
curve(pexp(x, rate = lambda), from=0, to=12, col='red', add = TRUE)
```

Question 2 a

Let us consider a new example where the PDF has the form
$$
g(x) = 
\begin{cases}
cx^{\alpha -1},& \quad 0 < x < 1 \\
ce^{-x},& \quad x  \ge 1 \\
\end{cases}
$$

The cumulative function can be computed with integration

$$
G(x) = 
\begin{cases}
\frac{c}{\alpha}x^{\alpha},& \quad 0 < x < 1 \\
\frac{c}{\alpha} -c(e^{-x} - e^{-1}),& \quad x  \ge 1 \\
0, &\quad \text{otherwise}
\end{cases}
$$

And similarly with the inverse cumulative function

$$
G^{-1} (y) = \begin{cases}
 \frac{1}{\alpha} ln(y \frac{\alpha}{c}), \quad 0<y < c/\alpha \\
-ln( e^{-1} - y/c + \frac{1}{\alpha}), \quad y\geq c/\alpha \\
0, \quad \text{otherwise}
\end{cases}
$$

with c as $\frac{e\alpha}{e+\alpha}$ in all the expressions. 

Question 2 b 

This distribution can be plotted by using the inverse cumulative distribution as before.

```{r}
# for u < c/alpha
c <- function(alpha) {
  return(exp(1)*alpha/(exp(1)+alpha))
}

dist1 <- function(alpha, n) {
   u <- runif(n)
   x <- 1/alpha*log(u*alpha/c(alpha))
   list = list(x, u)
   return(list)
}


n <- 60000
alpha <- 0.5
outval1 <- dist1(alpha, n)
plot(outval1[[1]], outval1[[2]], xlab = "x", ylab = "y", xlim = c(0, c(alpha)/alpha))

dist2 <- function(alpha, n) {
  u <- runif(n)
  x <- -log(exp(-1)-u/c(alpha)+1/alpha)
  list = list(x, u)
  return(list)
}

outval2 <- dist2(alpha, n)
points(outval2[[1]], outval2[[2]], xlab = "x", ylab = "y", ylim = c(alpha)/alpha, 10)
```

Question 3 a
The normalizing constant is found by using that a PDF must integrate to 1, and therefore we get $c = \alpha$.

Question 3 b
By integrating the PDF from $-\inf$ to x, we find the CDF: 
$$ 
F(x) = \frac{-1}{1+e^{\alpha x}}+1
$$
and the inverse of F is found by solving for x (where $F(x)$ is $y$:
$$
F^{-1}(x) = \frac{1}{\alpha}ln(\frac{-y}{y-1})
$$

Question 3 c
```{r}
dist3 <- function(alpha, n) {
   u <- runif(n)
   x <- 1/alpha*log(-u/(u-1))
   list = list(x, u)
   return(list)
}

outval3 <- dist3(alpha, n)
plot(outval3[[1]], outval3[[2]], xlab = "x", ylab = "y")
```

Question 4
```{r}
mynormal <- function(n) {
  x1 <- runif(n, min = 0, max = 2*pi)
  x2 <- expdist(0.5, n)
  y1 <- sqrt(unlist(x2))*cos(x1)
  y2 <- sqrt(unlist(x2))*sin(x1)
  return(list(y1,y2))
}

n = 1000
mynormalout <- mynormal(n)
plot(mynormalout[[1]], mynormalout[[2]], xlab = "x", ylab = "y")
hist(mynormalout[[2]], breaks = 500)

x <- seq(-4, 4, length=100)
y <- dnorm(x)
lines(x,y, type = "l", lwd = 2, xlab = "", ylab = "", add = TRUE)
