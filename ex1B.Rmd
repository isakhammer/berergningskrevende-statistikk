---
title: "ex1b"
output: html_notebook
---

# Task B1
## Task B1a

The acceptance probability has the form
$$
\begin{align}
P(U \le  \frac{f(y)}{cg(y)}) &=  \int_{-\infty}^{\infty} \int_0^{\frac{f(y)}{cg(y)}}  f_{U,Y} (y,u) du dy \\
&=  \int_{-\infty}^{\infty} \int_0^{\frac{f(y)}{cg(y)}} 1\cdot g(y)   du dy \\
&=  1/c
\end{align}
$$

We know from task 1 that the $g(y)$ has the form 
# Task B1a


## Task B1b
We will now demonstrate how to generate $n$ samples of $f$
```{r}
#TODO: Generate n independent samples from f
```



# Task B2
## Task B2a

We can define the domain 
$$
C_f = \Big \{ (x_1, x_2) : 0 \le x_1 \le \sqrt{f^{*}\Big(\frac{x_2}{x_1}\Big)}  \Big \}
$$
where 
$$
f(x) =
\begin{cases}
x^{\alpha -1}e^{-x}, \quad & x> 0 \\
0, \quad & x\le 0 \\
\end{cases}
$$ We now want to define some upper and lower bounds such that 
$$
\begin{align}
a_{-} &= \sqrt{{sup}_x f(x)  } = \sqrt{f(\alpha -1)} \\ 
b_{+} &= \sqrt{{sup}_{x \ge 0} x^2 f(x)  } = \sqrt{(\alpha +1)^2 f(\alpha +1)}\\
b_{-} &= \sqrt{{sup}_{x \le 0} x^2 f(x)  } = 0
\end{align}
$$

The supremum for $a_{-}$ and $b_{+}$ can easily be derived by finding extremal points of the function using derivation and $b_{-}$ follows from $f(x) = 0$ for $x\le 0$.

## Task B2b

We now want to generate $n$ samples of $f$ for different values of $alpha$ 

However, the explicit function will quickly become very large for big $\alpha$. To handle this will we introduce the substitution $x = ln(y) = g(y)$ such that $g^{-1} (x) = e^x,  g^{-1}`(x) = e^x $. Hence, using the change of variable function, we get

$$
\begin{align}
f_Y (y) &= f_X(g^{-1}(x))\cdot \left| \frac{d g^{-1}(x)} {dx} \right| \\
  &= f_X(e^x) \cdot  e^x  \quad \text{completely wrong}
\end{align}
$$

```{r}
# TODO: Write an R function that generates a vector of n independent samples from f. Use the function
# to check how many tries the algorithm needs to generate n = 1000 realisations depending on
# the value of α ∈ (1, 2000]. Generate a plot with values of α on the x-axis and the number of
# tries used on the y-axis. Interpret the result.
# Caution: You need to implement the algorithm on log-scale, otherwise you will get NAs already
# for α around 30.
```


# Task B3


We want to generate $n$ samples of the gamma distribution

$$
f(x) = \frac{\beta^{\alpha}}{\Gamma (\alpha)} x^{\alpha -1} e^{-\beta}
$$



```{r}
# TODO: Write an R function that generates a vector of n independent samples from f. Use the function
# to check how many tries the algorithm needs to generate n = 1000 realisations depending on
# the value of α ∈ (1, 2000]. Generate a plot with values of α on the x-axis and the number of
# tries used on the y-axis. Interpret the result.
# Caution: You need to implement the algorithm on log-scale, otherwise you will get NAs already
# for α around 30.
```
